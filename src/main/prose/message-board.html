<html>
<!-- 
This work is released into the Public Domain under the
terms of the Creative Commons CC0 1.0 Universal license.
https://creativecommons.org/publicdomain/zero/1.0/
-->
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" type="text/css" href="pityoulish.css" />
<title>Message Board - Functional Description</title>
</head>
<body>
<h1 id="board" class="title">
  <span>Message Board</span>
</h1>
<p class="abstract">
The programming exercises revolve around the Message Board.
Its functionality remains the same, regardless of the
communication technology employed between clients and the server.
</p>

<p class="larger">
The Message Board is a collection of <a href="#messages">messages</a>
maintained by a server.
Clients can read messages in batches, and add new messages one at a time.
Adding a message requires a valid <a href="#tickets">ticket</a>.
The server may generate additional system messages.
Old messages eventually drop off the board.
</p>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<h2 id="messages">
  <span>Messages</span>
  <a href="#messages" class="here-link">&para;</a>
</h2>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<h3 id="message-data">
  <span>Data</span>
  <a href="#message-data" class="here-link">&para;</a>
</h3>

<p>
Each message on the board comprises...
</p>
<ul>
<li><span class="title">Originator:</span>
  The source of the message.
  For regular messages, the username corresponding to the
  <a href="#tickets">ticket</a> provided by the client.
  For system messages, a value that is not a valid username.
</li>

<li><span class="title">Timestamp:</span>
  When the message was put on the board.
  Generated by the server.
</li>

<li><span class="title">Text:</span>
  The contents of the message.
  A string of Unicode characters, provided by the originator.
  Keep it short and to the point, there is a size limit.
</li>
</ul>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<h3 id="message-ops">
  <span>Operations</span>
  <a href="#message-ops" class="here-link">&para;</a>
</h3>

<dl>
<dt id="ListMessages">List Messages</dt>
<dd>
  Obtains a batch of messages from the board, and a
  marker for the latest message returned in the batch.
  The client can provide the marker to a subsequent call,
  to obtain only newer messages.
  Otherwise, the server returns the oldest messages on the board.
  The client specifies a maximum batch size.
  The server returns as many messages as are available and fit in the batch.
  If the client provides a marker, the server indicates if messages might
  have dropped off the board since the preceding call.
</dd>

<dt id="PutMessage">Put Message</dt>
<dd>
  Puts a new message on the board.
  The client provides the message text, and a <a href="#tickets">ticket</a>.
  The server may reject messages that are too long
  or contain control characters.
  The maximum length is implementation dependent, but no less than 79.
</dd>
</dl>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<h2 id="tickets">
  <span>Tickets</span>
  <a href="#tickets" class="here-link">&para;</a>
</h2>
<p>
A ticket authorizes certain operations, such as putting a message on the board.
Tickets are issued to users. A user can hold only one ticket at a time.
Tickets are valid for a limited timespan, in the range of a few minutes.
Tickets authorize a limited number of operations, for example three.
Exhausting the number of operations does not invalidate a ticket,
but makes it useless. A ticket can be returned or replaced before it expires,
even if the number of operations is exhausted.
</p>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<h3 id="ticket-data">
  <span>Data</span>
  <a href="#ticket-data" class="here-link">&para;</a>
</h3>

<ul>
<li><span class="title">Username:</span>
  A string of 6 to 12 characters from the range A-Z, a-z, and 0-9.
  The programming exercises generally do not authenticate users.
  Unless indicated otherwise, just choose a username you like.
</li>
<li><span class="title">Ticket:</span>
  A string of US-ASCII characters, excluding control characters, whitespace,
  and anything that might be misinterpreted by the prevalent shells.
  Thus it is safe to pass the ticket as a command-line argument. A ticket may,
  but does not have to, include the username for which it was issued.
</li>
</ul>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<h3 id="ticket-ops">
  <span>Operations</span>
  <a href="#ticket-ops" class="here-link">&para;</a>
</h3>

<dl>
<dt id="ObtainTicket">Obtain Ticket</dt>
<dd>
  Requests a ticket from the server.
  The client specifies the username for which to issue the ticket.
  If that user already holds a ticket, the operation fails.
  On success, the server returns a new ticket for the user.
  The server determines the timespan for which the ticket is valid,
  and the number of operations it authorizes.
  This information is not provided to the client.
  <!-- That keeps the API or protocol simple, and
       lets the students encounter error situations.
       Hey, I wanna have some fun, too.
    -->
</dd>

<dt id="ReturnTicket">Return Ticket</dt>
<dd>
  Returns a ticket to the server.
  The client provides the ticket to return.
  On success, the server invalidates the ticket,
  so that the user may request a new one.
</dd>

<dt id="ReplaceTicket">Replace Ticket</dt>
<dd>
  Requests a ticket from the server, in replacement of another.
  The client provides the ticket to replace.
  On success, the server returns a new ticket for the user.
  The effect is similar to calling <a href="#ReturnTicket">Return Ticket</a>,
  followed by <a href="#ObtainTicket">Obtain Ticket</a>.
</dd>
</dl>

</body>
